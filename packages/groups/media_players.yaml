binary_sensor:
  - platform: template
    sensors:
      alle_hojttalere_playing:
        value_template: "{{ not is_state('media_player.alle_hojttalere', 'off') }}"
        friendly_name: Alle HÃ¸jttalere Spiller
        device_class: sound

      minis_playing:
        value_template: "{{ not is_state('media_player.minis', 'off') }}"
        friendly_name: Minis Spiller
        device_class: sound

sensor:
  - platform: template
    sensors:
      active_media_player:
        value_template: >
          {% set dev = namespace(active_player='') %}
          {% for item in states.group.all_media.attributes.entity_id if is_state(item, 'playing') %}
            {% if dev.active_player == '' %}
              {% set dev.active_player = item %}
            {% endif %}
          {%- endfor %}

          {{ dev.active_player }}

group:
  all_media:
    name: All Media
    entities:
      - media_player.sovevaerelse
      - media_player.kokken
      - media_player.badevaerelse

      - media_player.alle_hojttalere
      - media_player.minis

      - media_player.stue_shield
      - media_player.kokken_chromecast
      - media_player.kontor_chromecast
      - media_player.sovevaerelse_chromecast
      - media_player.bar_skaerm

      - media_player.kokken_soundbar
      - media_player.stue_soundbar

      - media_player.sovevaerelse_tv_dlna

      - media_player.hallway_tablet
      - media_player.kitchen_tablet

      - media_player.badevaerelse_mini
      - media_player.gang_mini
      - media_player.kokken_mini
      - media_player.kontor_mini
      - media_player.sovevaerelse_mini
      - media_player.stue_mini

      - media_player.kokken_soundbar_songpal
      - media_player.stue_soundbar_songpal
