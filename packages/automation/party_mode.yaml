group:
  party_mode:
    name: Party Mode
    entities:
      - input_boolean.party_mode
      - switch.party_button
      - sensor.party_button_battery

input_boolean:
  party_mode:
    initial: off
    icon: mdi:cake-variant

sensor:
  - platform: template
    sensors:
      party_mode:
        friendly_name: "Party Mode"
        value_template: >-
          {%- if is_state('binary_sensor.party_button_switch', 'unavailable') -%}
            -1.0
          {%- else -%}
            {{ '0.0' if is_state('input_boolean.party_mode', 'off') else '1.0' }}
          {%- endif -%}

automation:
  - alias: party_button_pressed
    initial_state: true
    trigger:
      platform: state
      entity_id: binary_sensor.party_button_switch
      to: 'on'
    action:
      service: input_boolean.toggle
      data:
        entity_id: input_boolean.party_mode
