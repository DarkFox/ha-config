automation:
   # Office Hue Dimmer #
  - alias: office_dimmer_on
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.office_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.office_dimmer
          state: '1_click_up'
    action:
      service: input_select.select_option
      data_template:
        option: 'Default'
        entity_id: >
          {% if is_state('input_boolean.office_separate_light_profile', 'on') %}
            input_select.office_light_profile
          {% else %}
            input_select.light_profile
          {% endif %}

  - alias: office_dimmer_up
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.office_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.office_dimmer
          state: '2_click_up'
        - condition: template
          value_template: >
            {% if is_state('input_boolean.office_separate_light_profile', 'on') %}
              {{ states.input_select.office_light_profile.state != 'Bright' }}
            {% else %}
              {{ states.input_select.light_profile.state != 'Bright' }}
            {% endif %}
    action:
      service: input_select.select_previous
      data_template:
        entity_id: >
          {% if is_state('input_boolean.office_separate_light_profile', 'on') %}
            input_select.office_light_profile
          {% else %}
            input_select.light_profile
          {% endif %}

  - alias: office_dimmer_down
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.office_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.office_dimmer
          state: '3_click_up'
        - condition: template
          value_template: >
            {% if is_state('input_boolean.office_separate_light_profile', 'on') %}
              {{ states.input_select.office_light_profile.state != 'Off' }}
            {% else %}
              {{ states.input_select.light_profile.state != 'Off' }}
            {% endif %}
    action:
      service: input_select.select_next
      data_template:
        entity_id: >
          {% if is_state('input_boolean.office_separate_light_profile', 'on') %}
            input_select.office_light_profile
          {% else %}
            input_select.light_profile
          {% endif %}

  - alias: office_dimmer_off
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.office_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.office_dimmer
          state: '4_click_up'
    action:
      service: input_select.select_option
      data_template:
        option: 'Off'
        entity_id: >
          {% if is_state('input_boolean.office_separate_light_profile', 'on') %}
            input_select.office_light_profile
          {% else %}
            input_select.light_profile
          {% endif %}

  - alias: office_activity_override_toggle
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.office_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.office_dimmer
          state: '1_hold_up'
    action:
      - service: input_boolean.toggle
        data:
          entity_id: input_boolean.office_activity_override
      - service: tts.amazon_polly_say
        data_template:
          entity_id: media_player.office_mini
          message: "Kontor overstyring {{'tilkoblet' if states('input_boolean.office_activity_override') == 'on' else 'frakoblet'}}"
 
  - alias: office_override_room_state_up
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.office_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.office_dimmer
          state: '2_hold_up'
        - condition: state
          entity_id: input_boolean.office_activity_override
          state: 'on'
    action:
      - service: input_select.select_previous
        data:
          entity_id: input_select.office_room_state

  - alias: office_override_room_state_up
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.office_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.office_dimmer
          state: '3_hold_up'
        - condition: state
          entity_id: input_boolean.office_activity_override
          state: 'on'
    action:
      - service: input_select.select_next
        data:
          entity_id: input_select.office_room_state
  
  - alias: office_separate_light_profile_toggle
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.office_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.office_dimmer
          state: '4_hold_up'
    action:
      - service: input_boolean.toggle
        data:
          entity_id: input_boolean.office_separate_light_profile
      - service: tts.amazon_polly_say
        data_template:
          entity_id: media_player.office_mini
          message: "Kontor separat lysstyring {{'tilkoblet' if states('input_boolean.office_separate_light_profile') == 'on' else 'frakoblet'}}"

  # Bedroom Hue Dimmer #
  - alias: bedroom_dimmer_on
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.bedroom_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.bedroom_dimmer
          state: '1_click_up'
    action:
      service: input_select.select_option
      data_template:
        option: 'Default'
        entity_id: >
          {% if is_state('input_boolean.guests', 'on') %}
            input_select.bedroom_light_profile
          {% else %}
            input_select.light_profile
          {% endif %}

  - alias: bedroom_dimmer_up
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.bedroom_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.bedroom_dimmer
          state: '2_click_up'
        - condition: template
          value_template: >
            {% if is_state('input_boolean.guests', 'on') %}
              {{ states.input_select.bedroom_light_profile.state != 'Bright' }}
            {% else %}
              {{ states.input_select.light_profile.state != 'Bright' }}
            {% endif %}
    action:
      service: input_select.select_previous
      data_template:
        entity_id: >
          {% if is_state('input_boolean.guests', 'on') %}
            input_select.bedroom_light_profile
          {% else %}
            input_select.light_profile
          {% endif %}

  - alias: bedroom_dimmer_down
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.bedroom_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.bedroom_dimmer
          state: '3_click_up'
        - condition: template
          value_template: >
            {% if is_state('input_boolean.guests', 'on') %}
              {{ states.input_select.bedroom_light_profile.state != 'Off' }}
            {% else %}
              {{ states.input_select.light_profile.state != 'Off' }}
            {% endif %}
    action:
      service: input_select.select_next
      data_template:
        entity_id: >
          {% if is_state('input_boolean.guests', 'on') %}
            input_select.bedroom_light_profile
          {% else %}
            input_select.light_profile
          {% endif %}

  - alias: bedroom_dimmer_off
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.bedroom_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.bedroom_dimmer
          state: '4_click_up'
    action:
      service: input_select.select_option
      data_template:
        option: 'Off'
        entity_id: >
          {% if is_state('input_boolean.guests', 'on') %}
            input_select.bedroom_light_profile
          {% else %}
            input_select.light_profile
          {% endif %}

  - alias: bedroom_dimmer_bedside_bright
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.bedroom_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.bedroom_dimmer
          state: '1_hold_up'
    action:
      service: light.turn_on
      data:
        brightness: 255
        color_temp: 350
        entity_id:
          - light.bedside

  - alias: bedroom_dimmer_bedside_dimmed
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.bedroom_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.bedroom_dimmer
          state: '2_hold_up'
    action:
      service: light.turn_on
      data:
        brightness: 32
        color_temp: 500
        entity_id:
          - light.bedside

  - alias: bedroom_dimmer_bedside_night
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.bedroom_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.bedroom_dimmer
          state: '3_hold_up'
    action:
      service: light.turn_on
      data:
        brightness: 1
        rgb_color: [255,0,0]
        entity_id:
          - light.bedside

  - alias: bedroom_dimmer_bedside_off
    initial_state: true
    trigger:
      - platform: state
        entity_id: sensor.bedroom_dimmer_last_updated
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: sensor.bedroom_dimmer
          state: '4_hold_up'
    action:
      service: light.turn_off
      data:
        entity_id:
          - light.bedside
