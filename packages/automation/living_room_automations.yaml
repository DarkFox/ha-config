automation:
  - alias: Barskab Ã¥bnet
    trigger:
        - platform: state
          entity_id: binary_sensor.barskab
          to: 'on'
    action:
      - service: scene.create
        data_template:
          scene_id: barskab_aabnet_restore
          entities:
            light.barskab_under:
              state: "{{ states('light.barskab_under') }}"
              brightness: "{{ state_attr('light.barskab_under', 'brightness') }}"
            light.barskab_over:
              state: "{{ states('light.barskab_over') }}"
              brightness: "{{ state_attr('light.barskab_over', 'brightness') }}"
            light.bar_spots:
              state: "{{ states('light.bar_spots') }}"
              brightness: "{{ state_attr('light.bar_spots', 'brightness') }}"
            light.bar_hylde_spots:
              state: "{{ states('light.bar_hylde_spots') }}"
              brightness: "{{ state_attr('light.bar_hylde_spots', 'brightness') }}"
            light.stue_bar:
              state: "{{ states('light.stue_bar') }}"
              brightness: "{{ state_attr('light.stue_bar', 'brightness') }}"
      - service: light.turn_on
        data:
          brightness: 255
          entity_id:
            - light.barskab_under
            - light.barskab_over
            - light.bar_spots
            - light.bar_hylde_spots
            - light.stue_bar

  - alias: Barskab lukket
    trigger:
        - platform: state
          entity_id: binary_sensor.barskab
          to: 'off'
    action:
      - service: scene.turn_on
        data:
          entity_id: scene.barskab_aabnet_restore
