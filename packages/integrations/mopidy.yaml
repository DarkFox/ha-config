media_player:
  - platform: mpd
    host: 40817795-mopidy

automation:
  - alias: start_mopidy_on_playlist_speaker
    trigger:
      - platform: state
        entity_id: media_player.mpd
        from: 'off'
      - platform: state
        entity_id: input_select.playlist_player
    action:
      - service: media_player.play_media
        data_template:
          entity_id: "{{ states('input_select.playlist_player') }}"
          media_content_id: !secret mopidy_cast_url
          media_content_type: MUSIC

  - alias: start_mopidy_on_playlist_speaker
    trigger:
      - platform: state
        entity_id: media_player.mpd
        to: 'off'
      - platform: state
        entity_id: input_select.playlist_player
    action:
      - service: media_player.turn_off
        data_template:
          entity_id: "{{ states('input_select.playlist_player') if trigger.entity_id == 'media_player.mpd' else trigger.from_state.state }}"
