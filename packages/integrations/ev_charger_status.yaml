sensor:
  # RSR

  # Spirii
  - platform: rest
    scan_interval: 120
    name: RSR P-Hus Spirii Ladere
    resource: https://api.elli.eco/searchandfind/v1/locations?evse_id=DK*SPI*EZ416*1
    headers:
      X-apikey: !secret elli_api_key
    value_template: "{{ value_json[0].charging_spots | selectattr('status', 'equalto', 'AVAILABLE') | list | length }}"
    json_attributes_path: $[0]
    json_attributes:
      - charging_spots

  - platform: rest
    scan_interval: 120
    name: RSR Hovedindgang Spirii Ladere
    resource: https://api.elli.eco/searchandfind/v1/locations?evse_id=DK*SPI*EZ3208*1
    headers:
      X-apikey: !secret elli_api_key
    value_template: "{{ value_json[0].charging_spots | selectattr('status', 'equalto', 'AVAILABLE') | list | length }}"
    json_attributes_path: $[0]
    json_attributes:
      - charging_spots

  - platform: rest
    scan_interval: 120
    name: RSR Blegdamsvej Spirii Ladere
    resource: https://api.elli.eco/searchandfind/v1/locations?evse_id=DK*SPI*EZM0094*1
    headers:
      X-apikey: !secret elli_api_key
    value_template: "{{ value_json[0].charging_spots | selectattr('status', 'equalto', 'AVAILABLE') | list | length }}"
    json_attributes_path: $[0]
    json_attributes:
      - charging_spots

  # Clever
  - platform: rest
    scan_interval: 120
    name: RSR P-Hus Clever Ladere
    resource: https://api.elli.eco/searchandfind/v1/locations?evse_id=DK*CLE*E11179*1
    headers:
      X-apikey: !secret elli_api_key
    value_template: "{{ value_json[0].charging_spots | selectattr('status', 'equalto', 'AVAILABLE') | list | length }}"
    json_attributes_path: $[0]
    json_attributes:
      - charging_spots

  - platform: rest
    scan_interval: 120
    name: RSR Patienthotel Clever Ladere
    resource: https://api.elli.eco/searchandfind/v1/locations?evse_id=DK*CLE*E11190*1
    headers:
      X-apikey: !secret elli_api_key
    value_template: "{{ value_json[0].charging_spots | selectattr('status', 'equalto', 'AVAILABLE') | list | length }}"
    json_attributes_path: $[0]
    json_attributes:
      - charging_spots

  - platform: rest
    scan_interval: 120
    name: RSR Hovedindgang Clever Ladere
    resource: https://api.elli.eco/searchandfind/v1/locations?evse_id=DK*CLE*E11106*1
    headers:
      X-apikey: !secret elli_api_key
    value_template: "{{ value_json[0].charging_spots | selectattr('status', 'equalto', 'AVAILABLE') | list | length }}"
    json_attributes_path: $[0]
    json_attributes:
      - charging_spots

  # E.on
  - platform: rest
    scan_interval: 120
    name: RSR Hovedindgang Eon Ladere
    resource: https://api.elli.eco/searchandfind/v1/locations?evse_id=DK*EDR*E12677
    headers:
      X-apikey: !secret elli_api_key
    value_template: "{{ value_json[0].charging_spots | selectattr('status', 'equalto', 'AVAILABLE') | list | length }}"
    json_attributes_path: $[0]
    json_attributes:
      - charging_spots

  - platform: rest
    scan_interval: 120
    name: RSR Nordfl√∏jen Eon Ladere
    resource: https://api.elli.eco/searchandfind/v1/locations?evse_id=DK*EDR*E12617
    headers:
      X-apikey: !secret elli_api_key
    value_template: "{{ value_json[0].charging_spots | selectattr('status', 'equalto', 'AVAILABLE') | list | length }}"
    json_attributes_path: $[0]
    json_attributes:
      - charging_spots

  # RSH

  # Spirii
  - platform: rest
    scan_interval: 120
    name: RSH P4 Spirii Ladere
    resource: https://api.elli.eco/searchandfind/v1/locations?evse_id=DK*SPI*EZ3253*1
    headers:
      X-apikey: !secret elli_api_key
    value_template: "{{ value_json[0].charging_spots | selectattr('status', 'equalto', 'AVAILABLE') | list | length }}"
    json_attributes_path: $[0]
    json_attributes:
      - charging_spots

  - platform: rest
    scan_interval: 120
    name: RSH P7 Spirii Ladere
    resource: https://api.elli.eco/searchandfind/v1/locations?evse_id=DK*SPI*EZ3144*1
    headers:
      X-apikey: !secret elli_api_key
    value_template: "{{ value_json[0].charging_spots | selectattr('status', 'equalto', 'AVAILABLE') | list | length }}"
    json_attributes_path: $[0]
    json_attributes:
      - charging_spots

  # Clever
  - platform: rest
    scan_interval: 120
    name: RSH P2 Clever Ladere
    resource: https://api.elli.eco/searchandfind/v1/locations?evse_id=DK*CLE*E11135*1
    headers:
      X-apikey: !secret elli_api_key
    value_template: "{{ value_json[0].charging_spots | selectattr('status', 'equalto', 'AVAILABLE') | list | length }}"
    json_attributes_path: $[0]
    json_attributes:
      - charging_spots

  # E.on
  - platform: rest
    scan_interval: 120
    name: RSH P2 Eon Ladere
    resource: https://api.elli.eco/searchandfind/v1/locations?evse_id=DK*EDR*E13641
    headers:
      X-apikey: !secret elli_api_key
    value_template: "{{ value_json[0].charging_spots | selectattr('status', 'equalto', 'AVAILABLE') | list | length }}"
    json_attributes_path: $[0]
    json_attributes:
      - charging_spots
# template:
#   - binary_sensor:
#       - name: "RSR P-Hus Spirii Lader Z416 Status"
#         state: "{{ (state_attr('sensor.rsr_p_hus_spirii_ladere', 'charging_spots') | selectattr('evse_id', 'equalto', 'DK*SPI*EZ416*1') | first).status == 'CHARGING' }}"
#         device_class: occupancy
#         attributes:
#           last_changed: "{{ (state_attr('sensor.rsr_p_hus_spirii_ladere', 'charging_spots') | selectattr('evse_id', 'equalto', 'DK*SPI*EZ416*1') | first).last_status_change | as_timestamp | int | timestamp_local }}"
#       - name: "RSR P-Hus Spirii Lader Z417 Status"
#         state: "{{ (state_attr('sensor.rsr_p_hus_spirii_ladere', 'charging_spots') | selectattr('evse_id', 'equalto', 'DK*SPI*EZ417*1') | first).status == 'CHARGING' }}"
#         device_class: occupancy
#         attributes:
#           last_changed: "{{ (state_attr('sensor.rsr_p_hus_spirii_ladere', 'charging_spots') | selectattr('evse_id', 'equalto', 'DK*SPI*EZ417*1') | first).last_status_change | as_timestamp | int | timestamp_local }}"
#       - name: "RSR P-Hus Spirii Lader Z418 Status"
#         state: "{{ (state_attr('sensor.rsr_p_hus_spirii_ladere', 'charging_spots') | selectattr('evse_id', 'equalto', 'DK*SPI*EZ418*1') | first).status == 'CHARGING' }}"
#         device_class: occupancy
#         attributes:
#           last_changed: "{{ (state_attr('sensor.rsr_p_hus_spirii_ladere', 'charging_spots') | selectattr('evse_id', 'equalto', 'DK*SPI*EZ418*1') | first).last_status_change | as_timestamp | int | timestamp_local }}"
#       - name: "RSR P-Hus Spirii Lader Z419 Status"
#         state: "{{ (state_attr('sensor.rsr_p_hus_spirii_ladere', 'charging_spots') | selectattr('evse_id', 'equalto', 'DK*SPI*EZ419*1') | first).status == 'CHARGING' }}"
#         device_class: occupancy
#         attributes:
#           last_changed: "{{ (state_attr('sensor.rsr_p_hus_spirii_ladere', 'charging_spots') | selectattr('evse_id', 'equalto', 'DK*SPI*EZ419*1') | first).last_status_change | as_timestamp | int | timestamp_local }}"
