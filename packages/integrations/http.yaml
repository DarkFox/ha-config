homeassistant:
  customize:
    binary_sensor.xperia_state:
      hidden: true
    binary_sensor.fire_tablet_state:
      hidden: true
    binary_sensor.hallway_tablet_state:
      hidden: true
    switch.xperia_switch:
      hidden: true
    switch.fire_tablet_switch:
      hidden: true
    switch.hallway_tablet_switch:
      hidden: true


group:
  tablet_sensors:
    name: Tablet Sensors
    entities:
      - sensor.hallway_tablet_brightness
      - sensor.fire_tablet_brightness

  hallway_tablet:
    name: Hallway Tablet
    entities:
      - input_number.hallway_tablet_brightness
      - switch.hallway_tablet
  fire_tablet:
    name: Fire Tablet
    entities:
      - input_number.fire_tablet_brightness
      - switch.fire_tablet

input_number:
  hallway_tablet_brightness:
    name: Hallway Tablet Brightness
    initial: 76
    min: 0
    max: 100
    step: 1
    unit_of_measurement: "%"
    icon: mdi:white-balance-sunny
  fire_tablet_brightness:
    name: Fire Tablet Brightness
    initial: 76
    min: 0
    max: 255
    step: 1
    icon: mdi:white-balance-sunny

automation:
  - alias: Hallway Tablet Brightness Moved
    trigger:
      platform: state
      entity_id: input_number.hallway_tablet_brightness
    action:
      - service: joaoapps_join.nexus_send_tasker
        data_template:
          command: 'brightness=:={{ states.input_number.hallway_tablet_brightness.state }}'

  - alias: Hallway Tablet Brightness Changed
    trigger:
      platform: state
      entity_id: sensor.hallway_tablet_brightness
    action:
       service: input_number.set_value
       data_template:
        entity_id: input_number.hallway_tablet_brightness
        value: '{{ states.sensor.hallway_tablet_brightness.state | int }}'

  - alias: Fire Tablet Brightness Moved
    trigger:
      platform: state
      entity_id: input_number.fire_tablet_brightness
    action:
      - service: joaoapps_join.fire_tablet_send_tasker
        data_template:
          command: 'brightness=:={{ states.input_number.fire_tablet_brightness.state }}'

  - alias: Fire Tablet Brightness Changed
    trigger:
      platform: state
      entity_id: sensor.fire_tablet_brightness
    action:
       service: input_number.set_value
       data_template:
        entity_id: input_number.fire_tablet_brightness
        value: '{{ states.sensor.fire_tablet_brightness.state | int }}'

switch:
  - platform: command_line
    switches:
      xperia_switch:
        command_on: "curl -X POST -d 'command=ON' http://192.168.33.104:8765/screen"
        command_off: "curl -X POST -d 'command=OFF' http://192.168.33.104:8765/screen"
      hallway_tablet_switch:
        command_on: "curl -X POST -d 'command=ON' http://192.168.33.105:8765/screen"
        command_off: "curl -X POST -d 'command=OFF' http://192.168.33.105:8765/screen"

  - platform: template
    switches:
      xperia:
        friendly_name: Xperia Tablet
        entity_id: binary_sensor.xperia_state
        value_template: "{{ is_state('binary_sensor.xperia_state', 'on') }}"
        turn_on:
          service: switch.turn_on
          data:
            entity_id: switch.xperia_switch
        turn_off:
          service: switch.turn_off
          data:
            entity_id: switch.xperia_switch
      fire_tablet:
        friendly_name: Fire Tablet
        entity_id: binary_sensor.fire_tablet_state
        value_template: "{{ is_state('binary_sensor.fire_tablet_state', 'on') }}"
        turn_on:
          service: joaoapps_join.fire_tablet_send_tasker
          data:
            command: "screen=:=ON"
        turn_off:
          service: joaoapps_join.fire_tablet_send_tasker
          data:
            command: "screen=:=OFF"
      hallway_tablet:
        friendly_name: Hallway Tablet
        entity_id: binary_sensor.hallway_tablet_state
        value_template: "{{ is_state('binary_sensor.hallway_tablet_state', 'on') }}"
        turn_on:
          service: switch.turn_on
          data:
            entity_id: switch.hallway_tablet_switch
        turn_off:
          service: switch.turn_off
          data:
            entity_id: switch.hallway_tablet_switch
