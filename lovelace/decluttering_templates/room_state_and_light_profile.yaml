card:
  type: vertical-stack
  cards:
    - type: custom:decluttering-card
      template: room_light_profile
      variables:
        - room: "[[room]]"

    - type: horizontal-stack
      cards:
        - type: "custom:button-card"
          size: 40px
          name: Aktivitet
          entity: sensor.[[room]]_activity_state
          icon: mdi:circle
          tap_action:
            action: fire-dom-event
            browser_mod:
              service: browser_mod.popup
              data:
                title: Rum Aktivitet
                content:
                  type: custom:decluttering-card
                  template: room_activity
                  variables:
                    - room: "[[room]]"

          hold_action:
            action: more-info
          state:
            - value: "on"
              icon: mdi:circle
              color: var(--state-active-color)
            - value: "predicted"
              icon: mdi:circle-half
              color: var(--state-active-color)
            - value: "off"
              icon: mdi:circle-outline
              color: var(--state-inactive-color)

        - type: "custom:button-card"
          size: 40px
          name: Overstyring
          entity: light.[[room]]_activity_override
          color: var(--state-active-color)
          tap_action:
            action: none
          hold_action:
            action: toggle

        - type: "custom:button-card"
          size: 40px
          name: Separat
          entity: light.[[room]]_separate_light_profile
          color: var(--state-active-color)
          tap_action:
            action: none
          hold_action:
            action: toggle

        - type: "custom:button-card"
          size: 40px
          name: Auto
          color: var(--state-active-color)
          entity: input_boolean.auto_light_profile

        - !include ../cards/lights/theme_button.yaml

    - type: conditional
      conditions:
        - entity: input_boolean.[[room]]_activity_override
          state: "on"
      card:
        type: entities
        show_title: false
        show_header_toggle: false
        entities:
          - entity: input_select.[[room]]_room_state
