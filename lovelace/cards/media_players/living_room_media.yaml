type: vertical-stack
cards:
  - !include media_shortcuts.yaml

  - type: horizontal-stack
    cards:
      - type: "custom:button-card"
        entity: binary_sensor.living_room_video_out
        icon: mdi:import
        show_name: false
        color: auto
        tap_action:
          action: none
        style:
          .: |
            #icon {
              border-right: 2px solid var(--border-color);
            }
      - type: "custom:button-card"
        entity: input_select.living_room_video_output
        icon: mdi:television
        show_name: false
        tap_action:
          action: call-service
          service: input_select.select_option
          service_data:
            entity_id: input_select.living_room_video_output
            option: TV
        state:
          - value: "Projektor"
            color: var(--paper-item-icon-color)
          - value: "TV"
            color: var(--paper-item-icon-active-color)
      - type: "custom:button-card"
        entity: input_select.living_room_video_output
        icon: mdi:projector
        show_name: false
        tap_action:
          action: call-service
          service: input_select.select_option
          service_data:
            entity_id: input_select.living_room_video_output
            option: Projektor
        extra_styles: |
          @keyframes fade1 {
            0% {
              filter: saturate(1.0);
            }
            50% {
              filter: saturate(0);
            }
            100% {
              filter: saturate(1.0);
            }
          }
        state:
          - value: "TV"
            color: var(--paper-item-icon-color)
          - operator: template
            value: >
              [[[
                return states['binary_sensor.projector_power'].state == 'off'
              ]]]
            color: var(--paper-item-icon-active-color)
            styles:
              icon:
                - animation: fade1 4s linear infinite
          - value: "Projektor"
            color: var(--paper-item-icon-active-color)

  - type: vertical-stack
    cards:
      - type: horizontal-stack
        cards:
          - type: "custom:button-card"
            name: Nvidia Shield
            icon: si:nvidia
            tap_action:
              action: call-service
              service: media_player.select_source
              service_data:
                entity_id: media_player.sync_box
                source: "Nvidia Shield"
            state:
              - operator: template
                value: >
                  [[[
                    return (states['media_player.sync_box'].attributes['source'] == 'Nvidia Shield')
                  ]]]
                color: var(--paper-item-icon-active-color)
          - type: "custom:button-card"
            name: Nintendo Switch
            icon: mdi:nintendo-switch
            tap_action:
              action: call-service
              service: media_player.select_source
              service_data:
                entity_id: media_player.sync_box
                source: "Nintendo Switch"
            state:
              - operator: template
                value: >
                  [[[
                    return (states['media_player.sync_box'].attributes['source'] == 'Nintendo Switch')
                  ]]]
                color: var(--paper-item-icon-active-color)
          - type: "custom:button-card"
            name: PC
            icon: mdi:desktop-tower-monitor
            tap_action:
              action: call-service
              service: media_player.select_source
              service_data:
                entity_id: media_player.sync_box
                source: "PC"
            state:
              - operator: template
                value: >
                  [[[
                    return (states['media_player.sync_box'].attributes['source'] == 'PC')
                  ]]]
                color: var(--paper-item-icon-active-color)
          - type: "custom:button-card"
            name: "Off"
            icon: mdi:power
            tap_action:
              action: call-service
              service: media_player.turn_off
              service_data:
                entity_id: media_player.sync_box

            state:
              - operator: template
                value: >
                  [[[
                    return (states['media_player.sync_box'].attributes['source'] == 'Off')
                  ]]]
                color: var(--paper-item-icon-active-color)

  - type: custom:mini-media-player
    name: Soundbar
    entity: media_player.stue_soundbar_songpal
    hide:
      icon: true
      controls: true

  - type: horizontal-stack
    cards:
      - type: custom:button-card
        size: 50px
        icon: mdi:volume-minus
        tap_action:
          action: call-service
          service: media_player.volume_down
          service_data:
            entity_id: media_player.stue_soundbar_songpal
      - type: custom:button-card
        size: 50px
        icon: mdi:volume-plus
        tap_action:
          action: call-service
          service: media_player.volume_up
          service_data:
            entity_id: media_player.stue_soundbar_songpal
      - type: "custom:button-card"
        size: 50px
        color: auto
        entity: switch.living_room_soundbar_night_mode
        show_name: false

  - type: conditional
    conditions:
      - entity: media_player.stue_shield
        state_not: "off"
    card:
      type: vertical-stack
      cards:
        - type: custom:mini-media-player
          name: NVIDIA
          artwork: full-cover
          entity: media_player.nvidia_shield_adb
          info: scroll
          hide:
            name: true
            volume: true
            controls: true
          style:
            .: |
              .cover, .mmp__bg, .mmp__container, ha-card {
                border-radius: 0 !important;
              }
        - type: horizontal-stack
          cards:
            - type: "custom:button-card"
              entity: media_player.nvidia_shield_adb
              icon: mdi:skip-previous
              show_name: false
              tap_action:
                action: call-service
                service: media_player.media_previous_track
                service_data:
                  entity_id: media_player.nvidia_shield_adb
            - type: "custom:button-card"
              entity: media_player.nvidia_shield_adb
              icon: mdi:play
              show_name: false
              state:
                - value: "playing"
                  icon: mdi:pause
              tap_action:
                action: call-service
                service: media_player.media_play_pause
                service_data:
                  entity_id: media_player.nvidia_shield_adb
            - type: "custom:button-card"
              entity: media_player.nvidia_shield_adb
              icon: mdi:skip-next
              show_name: false
              tap_action:
                action: call-service
                service: media_player.media_next_track
                service_data:
                  entity_id: media_player.nvidia_shield_adb
