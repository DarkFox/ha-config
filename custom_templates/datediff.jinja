{%- macro datetime_diff(t1, t2) -%}
    {%- set datetime1 = as_datetime(t1)|as_timestamp|timestamp_custom('%Y-%m-%d %H:%M:%S', true) -%}
    {%- set datetime2 = as_datetime(t2)|as_timestamp|timestamp_custom('%Y-%m-%d %H:%M:%S', true) -%}

    {%- set parts1 = datetime1.split(' ') -%}
    {%- set parts2 = datetime2.split(' ') -%}
    
    {%- set date1 = parts1[0].split('-') -%}
    {%- set date2 = parts2[0].split('-') -%}
    
    {%- set time1 = parts1[1].split(':') -%}
    {%- set time2 = parts2[1].split(':') -%}

    {%- set ns = namespace(differing_parts=[]) -%}

    {%- for i in range(date1 | length) -%}
        {%- if date1[i] != date2[i] -%}
            {%- set ns.differing_parts = ns.differing_parts + ['-'.join(date2[i:])] -%}
            {%- break -%}
        {%- endif -%}
    {%- endfor -%}
    
    {%- if ns.differing_parts | length > 0 -%}
        {%- set ns.differing_parts = ns.differing_parts + [':'.join(time2)] -%}
    {%- else -%}
        {%- for i in range(time1 | length) -%}
            {%- if time1[i] != time2[i] -%}
                {%- set ns.differing_parts = ns.differing_parts + [':'.join(time2[i:])] -%}
                {%- break -%}
            {%- endif -%}
        {%- endfor -%}
    {%- endif -%}
    {{ ns.differing_parts | join(' ') }}
{%- endmacro -%}
